; A054420: Number of connectable 3 X n binary matrices.
; Submitted by loader3229
; 1,3,13,87,585,3899,25973,173039,1152849,7680691,51171485,340922567,2271346969,15132518507,100818201477,671686589663,4475014115745,29814130048611,198632300941357,1323358787022391,8816685256575721,58739881939669659,391345911743072405,2607285162665376463,17370657813126766321,115729478762606596883,771030803712192761533,5136880478763163371687,34223718334018598301625,228010540920401661803979,1519087033834571654581413,10120696205750889588166079,67427665043354520462438209,449227001855401832745476291
; Formula: a(n) = truncate((min(n-1,(n-1)%3)*(min(n-1,(n-1)%3)*d(n-1)+c(n-1))+b(n-1)-2)/2)+1, b(n) = 25*d(n-3)+11*c(n-3)+9*b(n-3), b(8) = 51946, b(7) = 51946, b(6) = 51946, b(5) = 174, b(4) = 174, b(3) = 174, b(2) = 2, b(1) = 2, b(0) = 2, c(n) = -100*b(n-3)-119*c(n-3)-262*d(n-3), c(8) = -538612, c(7) = -538612, c(6) = -538612, c(5) = -1820, c(4) = -1820, c(3) = -1820, c(2) = -4, c(1) = -4, c(0) = -4, d(n) = 405*d(n-3)+184*c(n-3)+156*b(n-3), d(8) = 832744, d(7) = 832744, d(6) = 832744, d(5) = 2816, d(4) = 2816, d(3) = 2816, d(2) = 8, d(1) = 8, d(0) = 8

#offset 1

mov $1,2
mov $2,-4
mov $3,8
sub $0,1
lpb $0
  sub $0,3
  mov $4,$1
  mul $4,-100
  mov $5,$2
  mul $5,184
  mov $6,$3
  mul $6,25
  mov $7,$1
  mul $7,156
  mov $8,$2
  mul $8,11
  mov $9,$3
  mul $9,-262
  mul $3,405
  add $3,$5
  add $3,$7
  mul $1,9
  add $1,$6
  add $1,$8
  mul $2,-119
  add $2,$4
  add $2,$9
lpe
mul $3,$0
add $2,$3
mul $0,$2
add $0,$1
sub $0,2
div $0,2
add $0,1
