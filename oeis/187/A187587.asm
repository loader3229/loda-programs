; A187587: Number of 4-step E, S, NW and NE-moving king's tours on an n X n board summed over all starting positions.
; Submitted by loader3229
; 0,5,84,286,604,1038,1588,2254,3036,3934,4948,6078,7324,8686,10164,11758,13468,15294,17236,19294,21468,23758,26164,28686,31324,34078,36948,39934,43036,46254,49588,53038,56604,60286,64084,67998,72028,76174,80436,84814,89308,93918,98644,103486,108444,113518,118708,124014,129436,134974
; Formula: a(n) = c(n-1), b(n) = truncate((-34735*truncate((40064*truncate((-5329*b(n-1))/(-5329))+21316)/40064))/(-34735))+1, b(3) = 3, b(2) = 2, b(1) = 1, b(0) = 0, c(n) = d(n-2), c(3) = 286, c(2) = 84, c(1) = 5, c(0) = 0, d(n) = truncate((d(n-1)*(-34735*truncate((40064*truncate((-5329*b(n-1))/(-5329))+21316)/40064)+46071)+d(n-2)*(40064*truncate((-5329*b(n-1))/(-5329))+21316)+d(n-3)*(-5329*b(n-1)+5329))/13904), d(4) = 1588, d(3) = 1038, d(2) = 604, d(1) = 286, d(0) = 84

#offset 1

mov $3,5
mov $4,84
sub $0,1
lpb $0
  sub $0,1
  mul $1,-5329
  add $1,5329
  mul $2,$1
  mov $5,$2
  sub $1,5329
  div $1,-5329
  mul $1,40064
  add $1,21316
  mov $2,$3
  mul $3,$1
  add $5,$3
  div $1,40064
  mul $1,-34735
  add $1,46071
  mov $3,$4
  mul $4,$1
  add $5,$4
  sub $1,46071
  div $1,-34735
  add $1,1
  mov $4,$5
  div $4,13904
lpe
mov $0,$2
