; Ackermann function
;
; input:
;   $0 = i
;   $1 = n
;
; output:
;   $2 = A(i,n)
;
; temporary variables:
;   $3 = i+1
;   $4 = j
;   $5 = k
;   $6 = stop (flag)
;   $7..$(7+i) = diff (array)
;   $(8+i)..$(9+2i) = next (array)

; set arguments
mov $0,3      ; i = 3
mov $1,3      ; n = 3

; initialize i+1 variable
mov $3,$0     ; $3 = i
add $3,1      ; $3 = i+1

; initialize diff and next arrays
mov $4,$3     ; j = i+1
lpb $4,1      ; for j = i+1..1 do
  add $4,6    ;
  mov $$4,1   ;   diff[j] = 1
  add $4,$0   ;
  add $4,1    ;
  mov $$4,0   ;   next[j] = 0
  sub $4,$0   ;
  sub $4,8    ;
lpe           ; end for
add $6,$1     ; diff[0] = n+1

; main loop
lpb $7,$3     ; begin of descent loop over diff array

  ; update A
  mov $4,8
  add $4,$0
  add $4,$0
  mov $2,$$4
  add $2,1    ; A = next[i]+1

  mov $4,$3   ; j = i+1
  mov $5,0    ; stop = 0
  lpb $4,1    ; for j = i+1..1 do

    add $4,5  ;
    sub $$4,1 ;   diff[j]--
    add $4,$0 ;
    add $4,1  ;
    add $$4,1 ;   next[j]++
    sub $4,1  ;   j--
  lpe         ; end for

lpe           ; end of descent loop over diff array
